window.Flourish={external:true};window.FlourishConfig={public_url:"https://public.flourish.rocks/"},function(){"use strict";var t,e;function i(){if(null==t){var e=function(){var t=window.location;"about:srcdoc"==t.href&&(t=window.parent.location);var e={};return function(t,i,r){for(;r=i.exec(t);)e[decodeURIComponent(r[1])]=decodeURIComponent(r[2])}(t.search.substring(1).replace(/\+/g,"%20"),/([^&=]+)=?([^&]*)/g),e}();t="referrer"in e?/^https:\/\/medium.com\//.test(e.referrer):!("auto"in e)}return t}function r(t){var e=t||window.innerWidth;return e>999?650:e>599?575:400}function o(t,i){if(window.top!==window.self){var r=window;if("srcdoc"==r.location.pathname&&(r=r.parent),e)return t=parseInt(t,10),console.log("sending AMP message",t),void r.parent.postMessage({sentinel:"amp",type:"embed-size",height:t},"*");var o={sender:"Flourish",context:"iframe.resize",method:"resize",height:t,src:r.location.toString()};if(i)for(var n in i)o[n]=i[n];r.parent.postMessage(JSON.stringify(o),"*")}}function n(){return-1!==navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")}function a(t){window.addEventListener("message",function(e){if(null!=e.source&&(e.origin===document.location.origin||e.origin.match(/\/\/localhost:\d+$|\.flourish\.(?:local(:\d+)?|rocks|studio)$/))){var i;try{i=JSON.parse(e.data)}catch(t){return void console.warn("Unexpected non-JSON message: "+JSON.stringify(e.data))}if("Flourish"===i.sender){for(var r=document.querySelectorAll("iframe"),o=0;o<r.length;o++)if(r[o].contentWindow==e.source||r[o].contentWindow==e.source.parent)return void t(i,r[o]);console.warn("could not find frame",i)}}}),n()&&window.addEventListener("resize",s)}function s(){for(var t=document.querySelectorAll(".flourish-embed"),e=0;e<t.length;e++){var i=t[e];if(!i.getAttribute("data-width"))i.querySelector("iframe").style.width=i.offsetWidth+"px"}}var l={de:{credits:{default:"Erstellt mit Flourish"}},en:{credits:{default:"A Flourish data visualisation",chart:"A Flourish chart",map:"A Flourish map",survey:{text:"A Flourish survey visualisation",url:"https://flourish.studio/visualisations/survey-data/"},network:{text:"A Flourish network chart",url:"https://flourish.studio/visualisations/network-charts/"},scatter:"A Flourish scatter chart",sankey:"A Flourish sankey chart",quiz:"A Flourish quiz"}},es:{credits:{default:"Creado con Flourish"}},fr:{credits:{default:"Créé avec Flourish"}},it:{credits:{default:"Creato con Flourish"}},mi:{credits:{default:"Hangaia ki te Flourish"}},nl:{credits:{default:"Gemaakt met Flourish"}}};!function(){function t(){if(!window.FlourishLoaded){window.FlourishLoaded=!0;var t=window.Flourish&&window.Flourish.external,s="en",d=document.querySelector("meta[name='language'],meta[name='LANGUAGE']");d&&d.hasAttribute("content")&&(s=d.getAttribute("content").substr(0,2),l[s]||(s="en"));var u,c=Array.prototype.slice.call(document.querySelectorAll(".flourish-embed"));if(!t)for(var h=document.querySelectorAll("script"),m=0;m<h.length;m++){var f=h[m];if(f.src&&f.src.match(/(?:\.flourish\.(?:rocks|studio)|(?:localhost|flourish\.local)(?::\d+)?)\//g)&&f.src.match(/\/embed\.js$/)){if(!u){var p=f.getAttribute("src");u=p.substr(0,p.lastIndexOf("/resources"))+"/"}if(f.getAttribute("data-src")){var g=document.createElement("div");g.setAttribute("class","flourish-embed"),g.setAttribute("data-src",f.getAttribute("data-src")),f.getAttribute("data-height")&&g.setAttribute("data-height",f.getAttribute("data-height")),f.getAttribute("data-width")&&g.setAttribute("data-width",f.getAttribute("data-width")),f.parentNode.insertBefore(g,f),c.push(g)}}}if(c.length){var b=(e="#amp=1"==window.location.hash,{isFixedHeight:i,getHeightForBreakpoint:r,startEventListeners:a,notifyParentWindow:o,isSafari:n});for(m=0;m<c.length;m++){var w,v,A,y,F=c[m],x=F.getAttribute("data-src");if(x){var k=x.split("?"),C=k.length>1;x=k[0],t?(w=x,v=window.FlourishConfig.public_url,A="?utm_source=embed&utm_campaign="+x):(w=u+x+((y=0===x.indexOf("template/"))?"/preview":"/embed"),v=u+x+"/",A="?utm_source=showcase&utm_campaign="+x);var S=F.getAttribute("data-width"),E=F.getAttribute("data-height");!!E||(w+="?auto=1",E=b.getHeightForBreakpoint(S)+"px");var O=document.createElement("iframe");if(O.setAttribute("scrolling","no"),O.setAttribute("frameborder","0"),O.setAttribute("src",w),F.appendChild(O),S?O.style.width=S:b.isSafari()?O.style.width=F.offsetWidth+"px":O.style.width="100%",E&&("%"===E.charAt(E.length-1)&&(E=parseFloat(E)/100*F.parentNode.offsetHeight+"px"),O.style.height=E),!y&&!C){for(var L,N="",q=F.className.split(" "),z=0;z<q.length;z++)if("flourish-embed"!=q[z]&&0==q[z].indexOf("flourish-")){N=q[z].substr(9);break}N||(N=0==x.indexOf("story")?"story":"default"),"object"==typeof(L=l[s].credits[N]||l.en.credits[N]||l.en.credits.default)&&(L.url&&(v=L.url),L=L.text);var _=document.createElement("div");_.setAttribute("class","flourish-credit"),_.setAttribute("style","width:100%!important;margin:0 0 4px!important;text-align:right!important;font-family:Helvetica,sans-serif!important;color:#888!important;font-size:11px!important;font-weight:bold!important;font-style:normal!important;-webkit-font-smoothing:antialiased!important;");var H=document.createElement("a");H.setAttribute("href",v+A),H.setAttribute("target","_top"),H.setAttribute("style","display:inline-block!important;text-decoration:none!important;font:inherit!important;color:inherit!important;border:none!important;margin:0 5px!important;"),_.appendChild(H);var W=document.createElement("img");W.setAttribute("alt","Flourish logo"),W.setAttribute("src",window.FlourishConfig.public_url+"resources/bosh.svg"),W.setAttribute("style","font:inherit!important;width:auto!important;height:12px!important;border:none!important;margin:0 2px 0!important;vertical-align:middle!important;display:inline-block!important;"),H.appendChild(W);var I=document.createElement("span");I.setAttribute("style","font:inherit!important;color:#888!important;vertical-align:middle!important;display:inline-block!important;"),I.appendChild(document.createTextNode(L)),H.appendChild(I),F.appendChild(_)}}}b.startEventListeners(function(t,e){"resize"==t.method&&("number"==typeof t.height&&(t.height+="px"),t.height&&(e.style.height=t.height))})}else console.warn("Flourish: could not find anything to embed")}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()}()}();
//# sourceMappingURL=embed.js.map
